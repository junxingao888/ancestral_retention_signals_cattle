
# Load modules if needed (uncomment depending on your HPC)
# module load bcftools/1.17

echo "Job started on $(date)"
echo "Running on node $(hostname)"
echo "Using $SLURM_CPUS_PER_TASK threads"

# Input variables
VCF="wgs_african_sample555_autoSNPs_FINAL.vcf.gz"
LIST="list"  # make sure this file contains sample IDs (one per line)
OUT="MUTNGR_DP4_polymorphic.vcf.gz"

# Ensure fresh index for the input VCF
bcftools index -f --threads 16 "$VCF"

# Extract and filter
bcftools view --threads 16 \
  -S "$LIST" \
  -i 'MIN(FORMAT/DP)>4' \
  --min-ac 1 \
  -Oz -o "$OUT" "$VCF"

# Index output
bcftools index --threads 16 "$OUT"

echo "Finished on $(date)"
