# Annotate variants with SnpEff
# -v: verbose
# -stats: generate HTML summary report

java -Xmx50g -jar snpEff.jar \
  -v ARS-UCD1.3.99 \
  input.vcf.gz \
  > annotated_snpeff.vcf \
  -stats snpeff_summary.html

# Annotate candidate regions with Ensembl VEP
vep \
  --cache \
  --offline \
  --assembly ARS-UCD1.3 \
  --species bos_taurus \
  --input_file candidate_regions.vcf \
  --output_file candidate_regions_vep.txt \
  --vcf \
  --everything \
  --fork 8

# Extract affected gene names from VEP output
grep -v "^#" candidate_regions_vep.txt \
  | cut -f4 \
  | sort | uniq > candidate_genes.txt

# (optimal)Prepare gene list for DAVID, you can also do it manually online
cp candidate_genes.txt david_input.txt



